version: '3.7'

services:

 app:
  build:
   context: ./app
   args:
    - IMAGE=${APP_IMAGE}
    - VERSION=${APP_VERSION}
  container_name: ${APP_NAME}
  depends_on:
    - db
  image: localhost/search-and-replace:${APP_VERSION}

 db:
  container_name: ${DB_NAME}
  environment:
   - MYSQL_DATABASE=${DB_MYSQL_DATABASE}
   - MYSQL_USER=${DB_MYSQL_USER}
   - MYSQL_PASSWORD=${DB_MYSQL_PASSWORD}
   - MYSQL_ROOT_PASSWORD=${DB_MYSQL_ROOT_PASSWORD}
  image: ${DB_IMAGE}:${DB_VERSION}
  volumes:
   - ./db:/docker-entrypoint-initdb.d
